kubitect:
  # url: "https://github.com/MusicDin/kubitect"
  # version: "v2.0.7"
  url: "https://github.com/seumasdunlop/kubitect/"
  version: "master"
hosts:
  - name: cb-tbn-01
    connection:
      type: remote
      user: coralbay
      ip: 192.168.40.212
      ssh:
        keyfile: "~/.ssh/id_rsa"
    mainResourcePoolPath: "/var/vmdata"
    dataResourcePools:
      - name: data
        path: "/var/vmdata"
  - name: cb-tbn-02
    connection:
      type: remote
      user: coralbay
      ip: 192.168.40.217
      ssh:
        keyfile: "~/.ssh/id_rsa"
    mainResourcePoolPath: "/var/vmdata"
    dataResourcePools:
      - name: data
        path: "/var/vmdata"
  - name: tbn-witness
    connection:
      type: remote
      user: coralbay
      ip: 192.168.40.214
      ssh:
        keyfile: "~/.ssh/id_rsa"
    mainResourcePoolPath: "/var/vmdata"
    dataResourcePools:
      - name: data
        path: "/var/vmdata"
cluster:
  name: "tbn-k8s-cluster"
  network:
    mode: "bridge"
    cidr: "192.168.40.0/24"
    bridge: "br0"
    gateway: "192.168.40.1"
    # dns: ["192.168.40.100"]
  nodeTemplate:
    user: "k8s"
    ssh:
      addToKnownHosts: false  # disabled because the tf step fails with IP issue
      # privateKeyPath: # set an explicit private key (instead of using auto-generated ./config/.ssh/)
    os:
      distro: "ubuntu"
      source: "https://cloud-images.ubuntu.com/releases/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img"
      # networkInterface: "br0"
    dns: ["192.168.40.100"]
    updateOnBoot: false
  nodes:
    loadBalancer:
      vip: 192.168.40.220
      default:
        ram: 4 # GiB
        cpu: 1 # vCPU
        mainDiskSize: 16 # GiB
      instances:
        - id: 1
          ip: 192.168.40.221
          host: cb-tbn-01
        - id: 2
          ip: 192.168.40.222
          host: cb-tbn-02
    master:
      default: # Default properties of all master node instances
        ram: 6
        cpu: 2
        mainDiskSize: 32
      instances: # Master node instances
        - id: 1
          host: cb-tbn-01
          ip: 192.168.40.223
        - id: 2
          host: tbn-witness
          ip: 192.168.40.224
        - id: 3
          host: cb-tbn-02
          ip: 192.168.40.225
    worker:
      default:
        mainDiskSize: 64
      instances:
        - id: 1 # core-1
          host: cb-tbn-01
          ip: 192.168.40.226
          cpu: 16
          ram: 48
          labels:
            - coralbay.tv/node-type: "core"
          dataDisks:
            - name: pvc
              pool: data
              size: 600
        - id: 2 # pipeline-1
          host: cb-tbn-01
          ip: 192.168.40.227
          cpu: 12
          ram: 16
          labels:
            - coralbay.tv/node-type: "pipeline"
            - coralbay.tv/pipeline-type: "main"
            - coralbay.tv/disk-mapped: "true"
          taints:
            - "node-type.coralbay.tv=pipeline:NoSchedule"
          # need annotations? - coralbay.tv/video-lan-ips=["192.168.80.227"]
        - id: 10 # core-2
          host: cb-tbn-02
          ip: 192.168.40.228
          cpu: 16
          ram: 48
          labels:
            - coralbay.tv/node-type: "core"
          dataDisks:
            - name: pvc
              pool: data
              size: 600
        - id: 11 # pipeline-2
          host: cb-tbn-02
          ip: 192.168.40.229
          cpu: 12
          ram: 16
          labels:
            - coralbay.tv/node-type: "pipeline"
            - coralbay.tv/pipeline-type: "backup"
            - coralbay.tv/disk-mapped: "true"
          taints:
            - "node-type.coralbay.tv=pipeline:NoSchedule"
kubernetes:
  version: "v1.22.6"
  networkPlugin: "calico"
  dnsMode: "coredns"
  kubespray:
    version: "release-2.19" # need a fix that hasn't made it to a release tag so using branch - https://github.com/kubernetes-sigs/kubespray/issues/8960
    # url: URL to custom Kubespray git repository.
    #      (default is: https://github.com/kubernetes-sigs/kubespray.git)

